id: core-task-manager-dependency-tracking
name: "Task Manager: Dependency Tracking - Map Task Dependencies"
description: |
  Tests the task-manager's ability to identify and map task dependencies
  in JSON subtask files.
  
  Validates:
  - Identifies task dependencies
  - Maps dependency relationships in depends_on
  - Includes dependencies in JSON tasks
  
  Critical Behavior:
  - MUST identify which tasks depend on others
  - MUST map dependencies in depends_on arrays
category: developer

prompts:
  - text: |
      Break down the feature "api-integration" into JSON subtasks.

      Objective: Build a reusable API client with authentication and error handling.
      Deliverables:
      - src/api/client.ts
      - src/api/auth.ts
      - src/api/service.ts
      - src/api/errors.ts

      Tasks:
      1. Design API client interface
      2. Implement HTTP client
      3. Add authentication layer (depends on HTTP client)
      4. Create API service methods (depends on auth layer)
      5. Add error handling (depends on API service)

      Use the write tool to create .tmp/tasks/api-integration/task.json and subtask_NN.json files.

approvalStrategy:
  type: auto-approve

behavior:
  mustUseTools:
    - read
    - bash
    - write
  requiresContext: true
  expectedContextFiles:
    - .opencode/context/core/task-management/navigation.md
    - .opencode/context/core/task-management/standards/task-schema.md
    - .opencode/context/core/task-management/guides/splitting-tasks.md
    - .opencode/context/core/task-management/guides/managing-tasks.md
  minToolCalls: 3
  maxToolCalls: 15

expectedViolations:
  - rule: approval-gate
    shouldViolate: true
    severity: error
    description: Subagents do not request approvals

timeout: 120000

tags:
  - task-manager
  - dependencies
  - planning
  - core-subagent
  - read-only
